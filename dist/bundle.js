(()=>{"use strict";function e(n,t){return 0===t?n:e(t,n%t)}function n(e){const n=[];for(let t=0;t<e.length;t++){const r=e.charCodeAt(t);n.push(r)}return n}const t=document.getElementById("prime_number_p"),r=document.getElementById("prime_number_q"),i=document.getElementById("message"),l=document.getElementById("btn_calculate");let c=document.getElementById("encrypted"),s=document.getElementById("decrypted"),a=document.getElementById("publicKey"),o=document.getElementById("privateKey"),u=document.getElementById("charToDecimal"),d=document.getElementById("decimalToChar");function m(e){if(e<=1)return!1;if(e<=3)return!0;if(e%2==0||e%3==0)return!1;for(let n=5;n*n<=e;n+=6)if(e%n==0||e%(n+2)==0)return!1;return!0}l.addEventListener("click",(function(g){g.preventDefault();const h=parseInt(t.value),f=parseInt(r.value),p=i.value;let I=!1;if(m(h)?""===t.value?(p_error_message.innerText="Das Feld darf nicht leer bleiben.",I=!0):p_error_message.innerText="":(p_error_message.innerText="Bitte geben Sie eine gültige Primzahl ein.",I=!0),m(f)?""===r.value?(q_error_message.innerText="Das Feld darf nicht leer bleiben.",I=!0):h===f?(q_error_message.innerText="Die zweite Primzahl darf nicht gleich der ersten Primzahl sein.",I=!0):q_error_message.innerText="":(q_error_message.innerText="Bitte geben Sie eine gültige Primzahl ein.",I=!0),""===i.value?(error_message.innerText="Das Feld darf nicht leer bleiben.",I=!0):error_message.innerText="",I)l.disabled=!1;else{const{publicKey:l,privateKey:m}=function(n,t){const r=n*t,i=(n-1)*(t-1),l=function(n){const t=[65537,65539,17,3];for(const r of t)if(1===e(r,n))return r;for(let t=2;t<n;t++)if(1===e(t,n))return t}(i),c=function(e,n){for(let t=1;t<n;t++)if(e*t%n==1)return t;return 1}(l,i);return{publicKey:{e:l,N:r},privateKey:{p:n,q:t,d:c}}}(h,f),g=function(e,t){const{e:r,N:i}=t,l=n(e),c=BigInt(r),s=BigInt(i);return l.map((e=>(BigInt(e)**c%s).toString())).join(" ")}(p,l),I=function(e,n){const{p:t,q:r,d:i}=n,l=e.split(" "),c=BigInt(i),s=BigInt(t),a=BigInt(r);return l.map((e=>{const n=BigInt(e)**c%(s*a);return Number(n)}))}(g,m);a.innerText="Schritt 1: Berechnen des öffentlichen Schlüssels: "+JSON.stringify(l),o.innerText="Schritt 2: Berechnen des privaten Schlüssels: "+JSON.stringify(m),u.innerHTML="Schritt 3: Umwandeln jedes Zeichens in eine Dezimalzahl (basierend auf der ASCII-Tabelle): "+p+" = "+n(p).join(" "),c.innerText="Schritt 4: Verschlüsseln der Nachricht mit dem öffentlichen Schlüssel: "+g,s.innerText="Schritt 5: Entschlüsseln der Nachricht mit dem privaten Schlüssel: "+I.join(" "),d.innerHTML="Schritt 6: Konvertieren jeder Dezimalzahl zurück in ein Zeichen (basierend auf der ASCII-Tabelle): "+I.join(" ")+" = "+I.map((e=>String.fromCharCode(e))).join(""),t.value="",r.value="",i.value=""}}))})();